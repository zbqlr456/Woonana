# 빌드 및 배포

&nbsp;

### 버전

- frontend
  - Vue.js: 2.9.6
- backend
  - Java : 11
  - Spring boot : 2.6.7
- database
  - mysql : 8.0.29
  - mongoDB: 5.0.8
- infra
  - nginx: 1.18.0
  - jenkin: **[Jenkins 2.332.3](https://www.jenkins.io/)**

&nbsp;

### 포트

- frontend : 80
- backend : 8081
- backend_chat : 8082
- database
  - mysql : 3306
  - mongoDB : 27017
- infra
  - jenkins : 9090

&nbsp;

### 배포

1. Jenkinsfile

   해당 깃 메인 페이지의 Jenkinsfile을 Jenkins의 Pipeline-Script에 작성한다.

2. nginx 설정 파일

   https 설정과 프론트에서 백엔드로 보내는 요청을 분산하기 위한 nginx 설정을 위해 `vi /etc/nginx/sites-available/default` 에 아래의 내용을 작성한다.

   ```java

   server {

           root /var/www/woonana/dist;

           # Add index.php to the list if you are using PHP

           index index.html index.htm index.nginx-debian.html;

           server_name k6b104.p.ssafy.io;

           listen [::]:443 ssl ipv6only=on; # managed by Certbot
           listen 443 ssl; # managed by Certbot
           ssl_certificate /etc/letsencrypt/live/k6b104.p.ssafy.io/fullchain.pem; # managed by Certbot
           ssl_certificate_key /etc/letsencrypt/live/k6b104.p.ssafy.io/privkey.pem; # managed by Certbot
           include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
           ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot

           location / {
                   root /var/www/woonana/dist;
                   try_files $uri $uri/ /index.html;
           }

           location /api {
                   proxy_pass http://localhost:8081;
                   proxy_set_header X-Real-IP $remote_addr;
                   proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                   proxy_set_header Host $http_host;
           }

           location /chatapi {
                   proxy_pass http://localhost:8082;
                   proxy_set_header X-Real-IP $remote_addr;
                   proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                   proxy_set_header Host $http_host;
           }
   }

   server {
       if ($host = k6b104.p.ssafy.io) {
           return 301 https://$host$request_uri;
       } # managed by Certbot

           listen 80 default_server;
           listen [::]:80 default_server;

           server_name k6b104.p.ssafy.io;
       return 404; # managed by Certbot

   }
   ```

&nbsp;

# 외부 서비스 정보

### [카카오 로그인 기능](https://developers.kakao.com/docs/latest/ko/kakaologin/common)

### **[AWS S3](https://aws.amazon.com/ko/s3/)**

&nbsp;

# **시연 시나리오**
